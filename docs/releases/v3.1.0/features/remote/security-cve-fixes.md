# Security CVE Fixes

## Summary

This release item addresses CVE-2025-27820, a security vulnerability in Apache HttpClient that could allow malicious domains to bypass domain-related checks in cookie management and hostname verification. The fix updates the httpclient5 and httpcore dependencies to patched versions.

## Details

### What's New in v3.1.0

The opensearch-remote-metadata-sdk now includes a fix for CVE-2025-27820 by forcing updated versions of Apache HttpClient dependencies through Gradle's resolution strategy.

### Technical Changes

#### Vulnerability Details

CVE-2025-27820 is a bug in Apache HttpClient that disables domain-related checks in critical functions like cookie management and hostname verification. This could potentially allow malicious domains to bypass security checks and engage in unauthorized activities.

#### Dependency Updates

| Dependency | Updated Version |
|------------|-----------------|
| org.apache.httpcomponents.client5:httpclient5 | 5.4.4 |
| org.apache.httpcomponents:httpcore | 5.3.4 |
| org.apache.httpcomponents.core5:httpcore5-h2 | 5.3.4 |

#### Implementation

The fix uses Gradle's `resolutionStrategy` to force the updated dependency versions:

```groovy
configurations.all {
    resolutionStrategy {
        force("org.apache.httpcomponents.client5:httpclient5:5.4.4")
        force("org.apache.httpcomponents:httpcore:5.3.4")
        force("org.apache.httpcomponents.core5:httpcore5-h2:5.3.4")

        eachDependency { DependencyResolveDetails details ->
            if (details.requested.group == 'org.apache.httpcomponents.client5' &&
                    details.requested.name == 'httpclient5') {
                details.useVersion "${versions.httpclient5}"
            }
        }
    }
}
```

### Migration Notes

No migration steps required. The dependency updates are transparent to users and do not change any APIs or behavior.

## Limitations

- This fix only applies to the opensearch-remote-metadata-sdk component
- Other OpenSearch components using Apache HttpClient should verify their dependency versions independently

## Related PRs

| PR | Description |
|----|-------------|
| [#195](https://github.com/opensearch-project/opensearch-remote-metadata-sdk/pull/195) | CVE fix for CVE-2025-27820 |

## References

- [CVE-2025-27820](https://www.sentinelone.com/vulnerability-database/cve-2025-27820/): Apache HttpClient Auth Bypass Vulnerability
- [opensearch-remote-metadata-sdk](https://github.com/opensearch-project/opensearch-remote-metadata-sdk): SDK for remote metadata storage

## Related Feature Report

- [Full feature documentation](../../../../features/remote/security-cve-fixes.md)
