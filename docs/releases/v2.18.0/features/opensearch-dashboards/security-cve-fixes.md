# Security CVE Fixes (Dashboards)

## Summary

OpenSearch Dashboards v2.18.0 addresses multiple security vulnerabilities by updating several npm dependencies to patched versions. These updates fix CVEs ranging from command injection to ReDoS (Regular Expression Denial of Service) vulnerabilities in commonly used JavaScript libraries.

## Details

### What's New in v2.18.0

This release includes security patches for 6 npm dependencies that had known CVEs:

| CVE | Package | Old Version | New Version | Severity |
|-----|---------|-------------|-------------|----------|
| CVE-2017-16100 | dns-sync | vulnerable | patched fork | Critical |
| CVE-2024-39338 | axios | 1.7.2 | 1.7.7 | High |
| CVE-2024-45296 | path-to-regexp | various | 1.9.0, 3.3.0, 6.3.0 | High |
| CVE-2024-45801 | dompurify | 3.0.11 | 3.1.6 | High |
| CVE-2024-48948 | elliptic | 6.5.7 | 6.6.0 | Low |
| N/A | micromatch | 4.0.7 | 4.0.8 | Medium |

### Technical Changes

#### CVE-2017-16100: dns-sync Command Injection

The `dns-sync` library had a critical command injection vulnerability. Since the upstream package hasn't been updated, a patched fork is used until the official package is fixed.

#### CVE-2024-39338: axios SSRF

The axios HTTP client had a Server-Side Request Forgery vulnerability that could allow attackers to bypass security controls. Updated from 1.7.2 to 1.7.7.

#### CVE-2024-45296: path-to-regexp ReDoS

The `path-to-regexp` library used for URL routing had a Regular Expression Denial of Service vulnerability. Multiple versions were updated across the dependency tree (1.9.0, 3.3.0, 6.3.0).

#### CVE-2024-45801: dompurify XSS Bypass

DOMPurify, used for HTML sanitization, had a vulnerability that could allow XSS attacks to bypass sanitization. Updated from 3.0.11 to 3.1.6.

#### CVE-2024-48948: elliptic Signature Malleability

The `elliptic` cryptographic library had a signature malleability issue. While categorized as low severity, it could cause administrative annoyance. Updated from 6.5.7 to 6.6.0.

#### micromatch Security Update

The `micromatch` glob matching library was updated from 4.0.7 to 4.0.8 to address security concerns.

### Migration Notes

No migration steps required. These are dependency updates that are transparent to users and administrators.

## Limitations

- The `dns-sync` fix uses a patched fork rather than the official package, pending upstream updates.

## References

### Documentation
- [CVE-2017-16100](https://nvd.nist.gov/vuln/detail/CVE-2017-16100): dns-sync command injection
- [CVE-2024-39338](https://nvd.nist.gov/vuln/detail/CVE-2024-39338): axios SSRF vulnerability
- [CVE-2024-45296](https://nvd.nist.gov/vuln/detail/CVE-2024-45296): path-to-regexp ReDoS
- [CVE-2024-45801](https://nvd.nist.gov/vuln/detail/CVE-2024-45801): dompurify XSS bypass
- [CVE-2024-48948](https://nvd.nist.gov/vuln/detail/CVE-2024-48948): elliptic signature malleability

### Pull Requests
| PR | Description |
|----|-------------|
| [#7811](https://github.com/opensearch-project/OpenSearch-Dashboards/pull/7811) | [CVE-2017-16100] Use a patched version for the `dns-sync` dependency |
| [#8026](https://github.com/opensearch-project/OpenSearch-Dashboards/pull/8026) | Bump `micromatch` from 4.0.7 to 4.0.8 |
| [#8197](https://github.com/opensearch-project/OpenSearch-Dashboards/pull/8197) | [CVE-2024-45296] Bump `path-to-regexp` to 1.9.0, 3.3.0, and 6.3.0 |
| [#8346](https://github.com/opensearch-project/OpenSearch-Dashboards/pull/8346) | [CVE-2024-45801] Bump `dompurify` from 3.0.11 to 3.1.6 |
| [#8490](https://github.com/opensearch-project/OpenSearch-Dashboards/pull/8490) | [CVE-2024-39338] Bump axios from 1.7.2 to 1.7.7 |
| [#8742](https://github.com/opensearch-project/OpenSearch-Dashboards/pull/8742) | [CVE-2024-48948] Bump `elliptic` from 6.5.7 to 6.6.0 |

## Related Feature Report

- [Full feature documentation](../../../../features/opensearch-dashboards/security-cve-fixes.md)
