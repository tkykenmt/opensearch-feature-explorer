---
tags:
  - opensearch-dashboards
---
# Dashboards CVE Fixes

## Summary

OpenSearch Dashboards v3.5.0 addresses multiple CVEs by upgrading js-yaml to 4.1.1 across all packages, removing unnecessary direct dependencies (`@modelcontextprotocol/sdk`, `node-forge`), and adding a Yarn resolution override to enforce the patched js-yaml version across the entire dependency tree.

## Details

### What's New in v3.5.0

This release fixes several security vulnerabilities in transitive dependencies through strategic dependency management:

#### CVEs Addressed

| CVE / Advisory | Package | Severity | Resolution |
|----------------|---------|----------|------------|
| [GHSA-mh29-5h37-fv8m](https://github.com/advisories/GHSA-mh29-5h37-fv8m) (CVE-2025-64718) | js-yaml | Moderate (CVSS 5.3) | Upgraded from 4.1.0 to 4.1.1 |
| [GHSA-w48q-cv73-mx4w](https://github.com/advisories/GHSA-w48q-cv73-mx4w) | @modelcontextprotocol/sdk | High | Removed as direct dependency |
| [GHSA-5gfm-wpxj-wjgq](https://github.com/advisories/GHSA-5gfm-wpxj-wjgq) | node-forge | High | Removed as direct dependency |
| [GHSA-554w-wpv2-vw27](https://github.com/advisories/GHSA-554w-wpv2-vw27) | node-forge | Medium | Removed as direct dependency |
| [GHSA-65ch-62r8-g69g](https://github.com/advisories/GHSA-65ch-62r8-g69g) | node-forge | Medium | Removed as direct dependency |
| [GHSA-wqch-xfxh-vrr4](https://github.com/advisories/GHSA-wqch-xfxh-vrr4) | body-parser | Medium | Resolved through transitive updates |
| [GHSA-rx8g-88g5-qh64](https://github.com/advisories/GHSA-rx8g-88g5-qh64) | min-document | Low | Resolved through transitive updates |

### Technical Changes

#### js-yaml Upgrade (4.1.0 → 4.1.1)

The primary CVE (CVE-2025-64718) is a prototype pollution vulnerability in js-yaml's YAML merge key (`<<`) handling. An attacker could modify the prototype of parsed YAML documents via `__proto__` keys.

Updated across 5 packages:
- Root `package.json`
- `packages/osd-agents/package.json`
- `packages/osd-apm-config-loader/package.json`
- `packages/osd-config/package.json`
- `packages/osd-optimizer/package.json`

A Yarn resolution override (`"**/js-yaml": "^4.1.1"`) forces all transitive instances (including those from eslint, grunt, load-grunt-config, istanbul, and api-documenter) to use the patched version. This also eliminates js-yaml v3.x from the dependency tree entirely — the `yarn.lock` consolidates all js-yaml references to 4.1.1.

The v3 → v4 upgrade is backward compatible because:
- `load()` became the safe method in v4 (previously unsafe)
- `safeLoad()` was removed (unnecessary since `load()` is now safe)
- No code in the dependency tree uses deprecated `safeLoad()` or unsafe `!!js/function` tags

#### Removed Direct Dependencies

- `@modelcontextprotocol/sdk` (`^1.18.0`): Pulled in automatically as a transitive dependency where needed
- `node-forge` (`^1.3.0`): Only used transitively via `node-forge@^1.2.1`

Removing these eliminates unnecessary version lock-in and simplifies dependency management.

## Limitations

- The Yarn resolution override forces js-yaml 4.x for all packages, including those that originally depended on 3.x — this works for standard YAML parsing but could break packages relying on js-yaml v3-specific APIs
- Transitive CVEs (body-parser, min-document) are resolved indirectly and may resurface if dependency trees change

## References

### Pull Requests
| PR | Description | Related Issue |
|----|-------------|---------------|
| [#11048](https://github.com/opensearch-project/OpenSearch-Dashboards/pull/11048) | CVE fixes | - |

### Security Advisories
- [GHSA-mh29-5h37-fv8m](https://github.com/advisories/GHSA-mh29-5h37-fv8m): js-yaml prototype pollution in merge (CVE-2025-64718)
- [GHSA-w48q-cv73-mx4w](https://github.com/advisories/GHSA-w48q-cv73-mx4w): @modelcontextprotocol/sdk vulnerability
- [GHSA-5gfm-wpxj-wjgq](https://github.com/advisories/GHSA-5gfm-wpxj-wjgq): node-forge vulnerability
- [GHSA-554w-wpv2-vw27](https://github.com/advisories/GHSA-554w-wpv2-vw27): node-forge vulnerability
- [GHSA-65ch-62r8-g69g](https://github.com/advisories/GHSA-65ch-62r8-g69g): node-forge vulnerability
- [GHSA-wqch-xfxh-vrr4](https://github.com/advisories/GHSA-wqch-xfxh-vrr4): body-parser vulnerability
- [GHSA-rx8g-88g5-qh64](https://github.com/advisories/GHSA-rx8g-88g5-qh64): min-document vulnerability
