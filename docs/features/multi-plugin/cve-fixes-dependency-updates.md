# CVE Fixes & Dependency Updates

## Summary

OpenSearch maintains security and stability through regular CVE fixes and dependency updates across its plugin ecosystem. This feature tracks security vulnerability remediation and dependency management across multiple repositories including alerting, security, anomaly-detection, reporting, index-management, and notifications plugins.

## Details

### Architecture

```mermaid
graph TB
    subgraph "OpenSearch Plugin Ecosystem"
        subgraph "Backend Plugins"
            A[alerting]
            IM[index-management]
        end
        subgraph "Dashboard Plugins"
            SD[security-dashboards]
            AD[anomaly-detection-dashboards]
            R[dashboards-reporting]
            N[dashboards-notifications]
        end
    end
    
    subgraph "Dependency Categories"
        SEC[Security Libraries]
        BUILD[Build Tools]
        TEST[Testing Frameworks]
        UI[UI Libraries]
    end
    
    A --> SEC
    A --> BUILD
    IM --> BUILD
    SD --> SEC
    AD --> UI
    R --> UI
    R --> TEST
    N --> TEST
```

### Components

| Component | Description |
|-----------|-------------|
| Security Libraries | axios, elliptic, dompurify - handle authentication, cryptography, and sanitization |
| Build Tools | Gradle plugins (nebula.ospackage, detekt), ktlint |
| Testing Frameworks | cypress, babel-jest |
| UI Libraries | jspdf, @babel/runtime, @babel/helpers |

### Common CVE Categories

| Category | Description | Typical Fix |
|----------|-------------|-------------|
| SSRF | Server-Side Request Forgery | Upgrade HTTP client libraries |
| XSS | Cross-Site Scripting | Upgrade sanitization libraries |
| Cryptographic | Weak cryptographic implementations | Upgrade crypto libraries |
| Prototype Pollution | JavaScript prototype manipulation | Upgrade affected packages |
| Arbitrary Code Execution | Remote code execution risks | Upgrade affected packages |

### Dependency Management Strategy

```mermaid
flowchart TB
    A[Dependabot/Mend Alert] --> B{Security CVE?}
    B -->|Yes| C[Priority Fix]
    B -->|No| D[Regular Update]
    C --> E[Create PR]
    D --> E
    E --> F[CI/CD Tests]
    F --> G{Tests Pass?}
    G -->|Yes| H[Merge]
    G -->|No| I[Fix Compatibility]
    I --> F
```

### Configuration

No user configuration required. Dependency updates are applied automatically during plugin installation.

## Limitations

- Dependency versions may be constrained by OpenSearch Dashboards compatibility requirements
- Some security fixes require coordinated updates across multiple plugins
- Dev dependencies (cypress, babel-jest) may be removed rather than updated to reduce attack surface

## Related PRs

| Version | PR | Repository | Description |
|---------|-----|------------|-------------|
| v3.0.0 | [#1802](https://github.com/opensearch-project/alerting/pull/1802) | alerting | Bump logback to 1.5.16 |
| v2.17.0 | [#864](https://github.com/opensearch-project/anomaly-detection-dashboards-plugin/pull/864) | anomaly-detection-dashboards | Address CVE-2024-4067 (micromatch) |
| v2.17.0 | [#1024](https://github.com/opensearch-project/alerting-dashboards-plugin/pull/1024) | alerting-dashboards | Pin braces for CVE-2024-4068 |
| v2.17.0 | [#1074](https://github.com/opensearch-project/alerting-dashboards-plugin/pull/1074) | alerting-dashboards | Fix CVE-2024-4067 (micromatch) |
| v2.17.0 | [#2138](https://github.com/opensearch-project/dashboards-observability/pull/2138) | dashboards-observability | Bump lint-staged for CVE-2024-4067 |
| v2.17.0 | [#2144](https://github.com/opensearch-project/security-dashboards-plugin/pull/2144) | security-dashboards | Bump micromatch for CVE-2024-4067 |
| v3.0.0 | [#993](https://github.com/opensearch-project/anomaly-detection-dashboards-plugin/pull/993) | anomaly-detection | Update @babel/runtime (CVE-2025-27789) |
| v3.0.0 | [#529](https://github.com/opensearch-project/dashboards-reporting/pull/529) | reporting | Bump jspdf to 3.0 (CVE-2025-26791) |
| v3.0.0 | [#555](https://github.com/opensearch-project/dashboards-reporting/pull/555) | reporting | Bump jspdf to 3.0.1 (CVE-2025-29907) |
| v3.0.0 | [#550](https://github.com/opensearch-project/dashboards-reporting/pull/550) | reporting | CVE fix for elliptic |
| v3.0.0 | [#558](https://github.com/opensearch-project/dashboards-reporting/pull/558) | reporting | CVE fix for babel/helpers |
| v3.0.0 | [#1374](https://github.com/opensearch-project/index-management/pull/1374) | index-management | Bump nebula.ospackage |
| v3.0.0 | [#338](https://github.com/opensearch-project/dashboards-notifications/pull/338) | notifications | Bump cypress |
| v3.0.0 | [#3484](https://github.com/opensearch-project/sql/pull/3484) | sql | CVE-2024-57699: Fix json-smart vulnerability |
| v3.0.0 | [#5173](https://github.com/opensearch-project/security/pull/5173) | security | Bump Spring version (CVE-2024-38827) |
| v3.0.0 | [#2196](https://github.com/opensearch-project/security-dashboards-plugin/pull/2196) | security-dashboards | Bump xlm-crypto and elliptic |
| v3.0.0 | [#2200](https://github.com/opensearch-project/security-dashboards-plugin/pull/2200) | security-dashboards | Bump babel to 7.27.0 |
| v3.0.0 | [#2232](https://github.com/opensearch-project/security-dashboards-plugin/pull/2232) | security-dashboards | Bump express to 5.1.0 |
| v3.0.0 | [#1077](https://github.com/opensearch-project/reporting/pull/1077) | reporting | Update gradle to 8.12.0 (JDK 23 support) |
| v3.0.0 | [#5148](https://github.com/opensearch-project/security/pull/5148) | security | Bump Gradle to 8.13 |
| v3.0.0 | [#5204](https://github.com/opensearch-project/security/pull/5204) | security | Bump logback-classic to 1.5.18 |
| v3.0.0 | [#5205](https://github.com/opensearch-project/security/pull/5205) | security | Bump guava to 33.4.6-jre |

## References

- [CVE-2024-4067 (GHSA-952p-6rrq-rcjv)](https://github.com/advisories/GHSA-952p-6rrq-rcjv): micromatch ReDoS vulnerability
- [CVE-2024-4068](https://nvd.nist.gov/vuln/detail/CVE-2024-4068): braces DoS vulnerability
- [CVE-2024-38827](https://nvd.nist.gov/vuln/detail/CVE-2024-38827): Spring Security authorization bypass
- [CVE-2024-57699](https://advisories.opensearch.org/advisories/CVE-2024-57699): json-smart vulnerability (High severity)
- [CVE-2025-27789](https://nvd.nist.gov/vuln/detail/CVE-2025-27789): @babel/runtime vulnerability
- [CVE-2025-26791](https://nvd.nist.gov/vuln/detail/CVE-2025-26791): jspdf vulnerability
- [CVE-2025-29774](https://nvd.nist.gov/vuln/detail/CVE-2025-29774): xml-crypto signature verification bypass
- [CVE-2025-29775](https://nvd.nist.gov/vuln/detail/CVE-2025-29775): xml-crypto signature verification bypass
- [CVE-2025-29907](https://nvd.nist.gov/vuln/detail/CVE-2025-29907): jspdf vulnerability
- [GHSA-vjh7-7g9h-fjfh](https://github.com/advisories/GHSA-vjh7-7g9h-fjfh): elliptic vulnerability

## Change History

- **v3.0.0** (2025-05-06): Multiple CVE fixes across alerting, security, anomaly-detection, reporting, index-management, notifications, sql, and security-dashboards plugins. Includes CVE-2024-57699 (json-smart), CVE-2024-38827 (Spring), and JDK 23 compatibility updates.
- **v2.17.0** (2024-09-17): CVE-2024-4067 and CVE-2024-4068 fixes across anomaly-detection-dashboards, alerting-dashboards, security-dashboards, and dashboards-observability
