# Security CVE Fixes (Dashboards)

## Summary

OpenSearch Dashboards maintains security by regularly updating npm dependencies to address known CVEs (Common Vulnerabilities and Exposures). This ongoing effort ensures that the dashboard application remains protected against security vulnerabilities in third-party libraries.

## Details

### Architecture

```mermaid
graph TB
    subgraph "OpenSearch Dashboards"
        OSD[OSD Application]
        subgraph "Security-Critical Dependencies"
            AXIOS[axios<br/>HTTP Client]
            DOMPURIFY[dompurify<br/>HTML Sanitizer]
            ELLIPTIC[elliptic<br/>Cryptography]
            PTR[path-to-regexp<br/>URL Routing]
            MM[micromatch<br/>Glob Matching]
            DNS[dns-sync<br/>DNS Resolution]
            TARFS[tar-fs<br/>Archive Extraction]
            PRISM[prismjs<br/>Syntax Highlighting]
            BABEL[@babel/runtime<br/>JS Runtime]
            NANOID[nanoid<br/>ID Generation]
            POSTCSS[postcss<br/>CSS Processing]
        end
    end
    OSD --> AXIOS
    OSD --> DOMPURIFY
    OSD --> ELLIPTIC
    OSD --> PTR
    OSD --> MM
    OSD --> DNS
    OSD --> TARFS
    OSD --> PRISM
    OSD --> BABEL
    OSD --> NANOID
    OSD --> POSTCSS
```

### Components

| Component | Purpose | Security Concern |
|-----------|---------|------------------|
| axios | HTTP client for API requests | SSRF vulnerabilities |
| dompurify | HTML sanitization to prevent XSS | XSS bypass vulnerabilities |
| elliptic | Elliptic curve cryptography | Signature malleability |
| path-to-regexp | URL path matching for routing | ReDoS vulnerabilities |
| micromatch | Glob pattern matching | ReDoS vulnerabilities |
| dns-sync | Synchronous DNS resolution | Command injection |
| tar-fs | Filesystem bindings for tar archives | Path traversal |
| prismjs | Syntax highlighting for code | ReDoS vulnerabilities |
| @babel/runtime | JavaScript runtime helpers | Code execution |
| nanoid | Unique ID generation | Predictable IDs |
| postcss | CSS processing tool | ReDoS vulnerabilities |
| cypress/request | HTTP request library (testing) | SSRF vulnerabilities |

### CVE Summary

| CVE | Package | Description | Severity |
|-----|---------|-------------|----------|
| CVE-2025-48387 | tar-fs | Path traversal during tar extraction | High |
| CVE-2025-27152 | axios | Server-Side Request Forgery | High |
| CVE-2025-27789 | @babel/runtime | Code execution vulnerability | Medium |
| CVE-2024-53382 | prismjs | Regular Expression DoS | Medium |
| CVE-2024-12905 | tar-fs | Path traversal vulnerability | High |
| CVE-2024-55565 | nanoid | Predictable ID generation | Low |
| CVE-2023-28155 | cypress/request | Server-Side Request Forgery | High |
| CVE-2023-44270 | postcss | Regular Expression DoS | Medium |
| GHSA-vjh7-7g9h-fjfh | elliptic | Signature verification issues | Medium |
| CVE-2017-16100 | dns-sync | Command injection via DNS lookup | Critical |
| CVE-2024-39338 | axios | Server-Side Request Forgery | High |
| CVE-2024-45296 | path-to-regexp | Regular Expression DoS | High |
| CVE-2024-45801 | dompurify | XSS sanitization bypass | High |
| CVE-2024-48948 | elliptic | ECDSA signature malleability | Low |
| CVE-2024-42459 | elliptic | Signature verification issue | Medium |
| CVE-2024-42460 | elliptic | Signature verification issue | Medium |
| CVE-2024-42461 | elliptic | Signature verification issue | Medium |

### Security Update Process

The OpenSearch Dashboards team follows a proactive security update process:

1. **Monitoring**: Automated tools (Dependabot, Mend) scan for CVEs
2. **Assessment**: Security team evaluates impact and urgency
3. **Patching**: Dependencies are updated to fixed versions
4. **Testing**: Comprehensive testing ensures no regressions
5. **Release**: Updates are included in the next release

## Limitations

- Some upstream packages may not receive timely updates, requiring forked/patched versions
- Transitive dependencies may require multiple version updates across the dependency tree
- Low-severity CVEs may still cause administrative overhead (e.g., security scanner alerts)

## Related PRs

| Version | PR | Description |
|---------|-----|-------------|
| v3.2.0 | [#10225](https://github.com/opensearch-project/OpenSearch-Dashboards/pull/10225) | [CVE-2025-48387] tar-fs 2.1.2 → 2.1.3, 3.0.8 → 3.1.0 |
| v3.0.0 | [#9681](https://github.com/opensearch-project/OpenSearch-Dashboards/pull/9681) | [CVE-2025-27789] Bump @babel/runtime, @babel/helpers, @babel/runtime-corejs3 |
| v3.0.0 | [#9649](https://github.com/opensearch-project/OpenSearch-Dashboards/pull/9649) | [CVE-2025-27789][CVE-2024-12905] Bump @babel/runtime to 7.26.10 and tar-fs to 2.1.2 |
| v3.0.0 | [#9634](https://github.com/opensearch-project/OpenSearch-Dashboards/pull/9634) | [CVE-2024-53382] Add prismjs 1.30.0 to resolutions |
| v3.0.0 | [#9546](https://github.com/opensearch-project/OpenSearch-Dashboards/pull/9546) | [GHSA-vjh7-7g9h-fjfh] Bump elliptic to 6.6.1 |
| v3.0.0 | [#9507](https://github.com/opensearch-project/OpenSearch-Dashboards/pull/9507) | [CVE-2025-27152] Bump axios to 1.8.2 |
| v3.0.0 | [#9503](https://github.com/opensearch-project/OpenSearch-Dashboards/pull/9503) | [CVE-2023-28155][CVE-2023-44270][CVE-2024-55565] Bump nanoid, cypress/request, postcss |
| v2.18.0 | [#7811](https://github.com/opensearch-project/OpenSearch-Dashboards/pull/7811) | [CVE-2017-16100] dns-sync patched version |
| v2.18.0 | [#8026](https://github.com/opensearch-project/OpenSearch-Dashboards/pull/8026) | micromatch 4.0.7 → 4.0.8 |
| v2.18.0 | [#8197](https://github.com/opensearch-project/OpenSearch-Dashboards/pull/8197) | [CVE-2024-45296] path-to-regexp updates |
| v2.18.0 | [#8346](https://github.com/opensearch-project/OpenSearch-Dashboards/pull/8346) | [CVE-2024-45801] dompurify 3.0.11 → 3.1.6 |
| v2.18.0 | [#8490](https://github.com/opensearch-project/OpenSearch-Dashboards/pull/8490) | [CVE-2024-39338] axios 1.7.2 → 1.7.7 |
| v2.18.0 | [#8742](https://github.com/opensearch-project/OpenSearch-Dashboards/pull/8742) | [CVE-2024-48948] elliptic 6.5.7 → 6.6.0 |

## References

- [CVE-2025-48387](https://nvd.nist.gov/vuln/detail/CVE-2025-48387): tar-fs path traversal
- [CVE-2025-27152](https://nvd.nist.gov/vuln/detail/CVE-2025-27152): axios SSRF vulnerability
- [CVE-2025-27789](https://nvd.nist.gov/vuln/detail/CVE-2025-27789): @babel/runtime vulnerability
- [CVE-2024-53382](https://github.com/advisories/GHSA-968p-4wvh-cqc8): prismjs ReDoS
- [CVE-2024-12905](https://nvd.nist.gov/vuln/detail/CVE-2024-12905): tar-fs path traversal
- [CVE-2024-55565](https://nvd.nist.gov/vuln/detail/CVE-2024-55565): nanoid predictable IDs
- [CVE-2023-28155](https://nvd.nist.gov/vuln/detail/CVE-2023-28155): request SSRF
- [CVE-2023-44270](https://nvd.nist.gov/vuln/detail/CVE-2023-44270): postcss ReDoS
- [GHSA-vjh7-7g9h-fjfh](https://github.com/advisories/GHSA-vjh7-7g9h-fjfh): elliptic signature verification
- [CVE-2017-16100](https://nvd.nist.gov/vuln/detail/CVE-2017-16100): dns-sync command injection
- [CVE-2024-39338](https://nvd.nist.gov/vuln/detail/CVE-2024-39338): axios SSRF vulnerability
- [CVE-2024-45296](https://nvd.nist.gov/vuln/detail/CVE-2024-45296): path-to-regexp ReDoS
- [CVE-2024-45801](https://nvd.nist.gov/vuln/detail/CVE-2024-45801): dompurify XSS bypass
- [CVE-2024-48948](https://nvd.nist.gov/vuln/detail/CVE-2024-48948): elliptic signature malleability

## Change History

- **v3.2.0** (2026-01-10): Fixed CVE-2025-48387; bumped tar-fs 2.1.2 → 2.1.3, 3.0.8 → 3.1.0
- **v3.0.0** (2025-05-13): Fixed CVE-2025-27152, GHSA-vjh7-7g9h-fjfh, CVE-2024-53382, CVE-2025-27789, CVE-2024-12905, CVE-2023-28155, CVE-2023-44270, CVE-2024-55565; bumped axios, elliptic, prismjs, @babel/runtime, tar-fs, nanoid, postcss, cypress/request
- **v2.18.0** (2024-11-05): Fixed CVE-2017-16100, CVE-2024-39338, CVE-2024-45296, CVE-2024-45801, CVE-2024-48948; bumped micromatch
